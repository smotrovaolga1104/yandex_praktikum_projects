# Прогнозирование оттока клиентов оператора связи

## Задача

Необходимо построить прототип модели, позволяющей предсказывать уход клиента на основании его персональных данных и условий его договора с провайдером. Модель должна достигать значения *ROC AUC* не менее 0.85. Проект должен быть завершен в течение двух недель с момента постановки задачи Заказчиком.

Использование модели позволит уменьшить маркетинговые расходы за счет более таргетированной работы по удержанию потенциально уходящих клиентов и экономии на привлечении новых пользователей.

Для реализации поставленной задачи следует:

1. Проанализировать предоставленные данные на предмет их полноты, релевантности, при необходимости устранить проблемы в данных;
2. Выбрать архитектуры моделей, наиболее подходящие для имеющихся данных;  
3. Подготовить данные для дальнейшего обучения модели: удалить нерелевантные данные, выделить из общего массива обучающую и тестовую выборки, при необходимости провести масштабирование, кодировку категориальных признаков и т.п.;
4. Обучить несколько типов моделей с подбором гиперпараметров для максимизации метрики качества;
5. На основании результатов кросс-валидации выбрать наилучшую модель, проверить ее качество на тестовой выборке;
6. Если выбранная модель не достигнет требуемого уровня качества, повторить п. выше, пока требуемый порог качества не будет достигнут.

## Данные

Оператор предоставляет два основных типа услуг: 

- Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
- Интернет. Подключение может быть двух типов: через телефонную линию (*DSL*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).  

Также доступны такие услуги:

- Интернет-безопасность: антивирус (*DeviceProtection*) и блокировка небезопасных сайтов (*OnlineSecurity*);
- Выделенная линия технической поддержки (*TechSupport*);
- Облачное хранилище файлов для резервного копирования данных (*OnlineBackup*);
- Стриминговое телевидение (*StreamingTV*) и каталог фильмов (*StreamingMovies*).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

Данные представлены в четырех отдельных файлах из разных источников:

- `contract.csv` — информация о договоре;
- `personal.csv` — персональные данные клиента;
- `internet.csv` — информация об интернет-услугах;
- `phone.csv` — информация об услугах телефонии.

## Основные выводы

Данные были объединены по id клиента; проведен исследовательский и корреляционный анализ, в результате которого составлен пул из 11 объясняющих признаков. 

Были выбраны три типа моделей для исследования: случайный лес и две модели градиентного бустинга (CatBoost и LGBM). Наилучшей моделью оказалась модель градиентного бустинга CatBoost (*ROC AUC* на тестовой выборке 0.95) со следующими гиперпараметрами:
- 300 итераций;
- шаг обучения 0.7;
- глубина дерева 2;
- веса классов [0.265, 0.735].

Однако предсказательная способность модели может быть смещена из-за особенностей исходных данных (факт разрыва договора зафиксирован только для последних четырех месяцев).

## Используемые библиотеки

*sklearn*, *lightgbm*, *catboost*, *phik*, *pandas*, *seaborn*
