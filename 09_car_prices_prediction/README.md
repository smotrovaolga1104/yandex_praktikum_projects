# Прогноз стоимости автомобилей

## Задача

Необходимо построить модель, позволяющую прогнозировать рыночную стоимость автомобиля в зависимости от его состояния и технических характеристик. Модель планируется использовать для сервиса по продаже автомобилей с пробегом. По условиям технического задания, для выбора оптимальной модели важны следующие характеристики:

- качество предсказания (*RMSE* не больше 2 500);
- скорость предсказания;
- время обучения.

Для реализации поставленной задачи необходимо:
- проанализировать предоставленные исходные данные и их качество (полнота, наличие выбросов и т.п.);
- по возможности устранить выявленные проблемы в данных, подготовить выборки;
- обучить несколько моделей разной степени сложности;
- сравнить модели по означенным характеристикам, выбрать оптимальную;
- проверить качество выбранной модели на тестовой выборке.

## Данные

Признаки:
- `DateCrawled` — дата скачивания анкеты из базы
- `VehicleType` — тип автомобильного кузова
- `RegistrationYear` — год регистрации автомобиля
- `Gearbox` — тип коробки передач
- `Power` — мощность (л. с.)
- `Model` — модель автомобиля
- `Kilometer` — пробег (км)
- `RegistrationMonth` — месяц регистрации автомобиля
- `FuelType` — тип топлива
- `Brand` — марка автомобиля
- `Repaired` — была машина в ремонте или нет
- `DateCreated` — дата создания анкеты
- `NumberOfPictures` — количество фотографий автомобиля
- `PostalCode` — почтовый индекс владельца анкеты (пользователя)
- `LastSeen` — дата последней активности пользователя

Целевой признак:
- `Price` — цена (евро)

## Основные выводы

В результате предобработки (в основной устранение пропусков и аномалий) выборка сократилась на 9% до ок. 325 тыс. объектов. Затем были исследованы три типа моделей - дерево решений, случайный лес и градиентный бустинг (с контролем времени обучения и прогноза). Наилучший баланс между временем работы и качеством модели продемонстрировала модель *градиентного бустинга* с шагом 0,3 и 300 итерациями (RMSE на тестовой выборке ок. 1 560).

## Используемые библиотеки
*sklearn*,*lightgbm*, *pandas*, *matplotlib*
