# Прогноз удержания клиентов банка

## Задача

Необходимо построить модель для прогноза, уйдёт ли клиент из банка в ближайшее время, на основе исторических данных о поведении клиентов и расторжении договоров с банком. Использование модели может помочь в уменьшении оттока клиентов "Бета-Банка" за счет лучшего распределения маркетинговых бюджетов, улучшения программ лояльности.

Выполнение поставленной задачи будет проходить в несколько этапов:

* Необходимо изучить предоставленные данные, при необходимости подготовить данные для дальнейшего использования в модели;
* Разбить датасет на обучающую, валидационнную и тестовую выборки, сохраняя репрезентативность;
* Обучить несколько видов моделей (дерево решений, случайный лес, логистическая регрессия), выявить оптимальную на основании метрик F1 и AUC ROC;
* Проверить выбранную модель на тестовых данных.

Модель должна достигать максимально возможного значения F1-меры (не менее 0.59).

## Данные

Признаки:
- `RowNumber` — индекс строки в данных
- `CustomerId` — уникальный идентификатор клиента
- `Surname` — фамилия
- `CreditScore` — кредитный рейтинг
- `Geography` — страна проживания
- `Gender` — пол
- `Age` — возраст
- `Tenure` — сколько лет человек является клиентом банка
- `Balance` — баланс на счёте
- `NumOfProducts` — количество продуктов банка, используемых клиентом
- `HasCrCard` — наличие кредитной карты
- `IsActiveMember` — активность клиента
- `EstimatedSalary` — предполагаемая зарплата

Целевой признак:
- `Exited` — факт ухода клиента

## Основные выводы

Выборка несбалансирована по классам (доля положительного ок. 20%). Были проведены предобработка и исследовательский анализ, а также кодирование категориальных признаков и масштабирование количественных (на основании обучающей выборки).

Были исследованы три типа моделей: дерево решений, случайный лес и логистическая регрессия. Модели без учета дисбаланса классов показали неудовлетворительные результаты - только у случайного леса F1-мера оказалась выше 0.59, хотя превышение минимально. Для улучшения качества моделей были применены два метода - взвешиване классов и увеличение обучающей выборки за счет положительных объектов. Наилучший результат показала модель случайного леса c 90 деревьями и глубиной дерева 8, обученная на увеличенной выборке (F1 на тестовой выборке 0.6057).

## Используемые библиотеки
*sklearn*, *pandas*, *plotly*
